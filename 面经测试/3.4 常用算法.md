å¥½ï¼Œå’±å°±æŠŠä½ è¿™èŠ‚â€œ3.4 å¸¸ç”¨ç®—æ³•â€å½“æˆä¸Šè¯¾æ¥è®²ä¸€éï¼Œå†é¡ºæ‰‹æ‰©å±•åˆ°ä¸€æ•´å¥—ä½ é¢è¯•èƒ½è¯´çš„ä¸œè¥¿ ğŸ‘

ä½ ç»™çš„æçº²åªæœ‰è¿™å‡ æ¡ï¼š

> - `std::sort`ã€`std::reverse`
> - `std::lower_bound` / `std::upper_bound`

æˆ‘æŒ‰è¿™ä¸ªä¸»çº¿æ¥ï¼Œå¤–åŠ å‡ ä¸ªå¼ºç›¸å…³çš„ï¼š`std::stable_sort`ã€`std::binary_search`ã€`std::equal_range`ã€`sort + unique` å»é‡å¥—è·¯ã€‚

------

## 0. ç»Ÿä¸€èƒŒæ™¯ï¼šå¤´æ–‡ä»¶ & è¿­ä»£å™¨è¦æ±‚

æ‰€æœ‰è¿™äº›ç®—æ³•éƒ½åœ¨å¤´æ–‡ä»¶ `<algorithm>` é‡Œï¼š

```cpp
#include <algorithm>
```

STL ç®—æ³•éƒ½æ˜¯â€œå…¨å±€å‡½æ•° + è¿­ä»£å™¨â€ï¼ŒåŸºæœ¬å½¢å¼ï¼š

```cpp
algorithm_name(first, last, ...);
```

- ä½œç”¨èŒƒå›´æ˜¯ `[first, last)` å·¦é—­å³å¼€ï¼›
- èƒ½ä¸èƒ½ç”¨åœ¨æŸä¸ªå®¹å™¨ä¸Šï¼Œå–å†³äº**è¿­ä»£å™¨ç±»å‹**ï¼ˆæ˜¯ä¸æ˜¯éšæœºè®¿é—®ã€è‡³å°‘å‰å‘ç­‰ï¼‰ï¼›
- å¤§éƒ¨åˆ†å®¹å™¨éƒ½å¯ä»¥ç”¨ï¼Œä½† **`std::sort` è¦æ±‚éšæœºè®¿é—®è¿­ä»£å™¨**ï¼ˆvector / deque / array / stringï¼‰ã€‚

------

## 1. `std::sort` â€”â€” æ’åºçš„æ ¸å¿ƒå…«è‚¡

### 1.1 åŸºæœ¬ä½¿ç”¨

```cpp
#include <algorithm>
#include <vector>

std::vector<int> v = {3, 1, 4};

std::sort(v.begin(), v.end());  // é»˜è®¤ä»å°åˆ°å¤§
```

**é»˜è®¤æ’åºè§„åˆ™**ï¼š

- å¯¹å†…ç½®ç±»å‹ï¼šä»å°åˆ°å¤§ï¼ˆä½¿ç”¨ `<`ï¼‰
- å¯¹è‡ªå®šä¹‰ç±»å‹ï¼šè¦æ±‚æœ‰ `operator<`

### 1.2 è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°

#### å†™æˆå‡½æ•°å¯¹è±¡ / å‡½æ•°æŒ‡é’ˆï¼š

```cpp
bool cmp_desc(int a, int b) {
    return a > b;  // â€œa åº”è¯¥æ’åœ¨ b å‰é¢â€ï¼Ÿ
}

std::sort(v.begin(), v.end(), cmp_desc);  // é™åº
```

#### å†™æˆ lambdaï¼ˆé¢è¯•é«˜é¢‘ï¼‰ï¼š

```cpp
std::sort(v.begin(), v.end(),
          [](const Path& a, const Path& b) {
              return a.slack < b.slack;  // slack å°çš„æ’å‰é¢
          });
```

**è®°å¿†å£è¯€**ï¼š

> `comp(a, b)` è¿”å› trueï¼Œè¡¨ç¤ºï¼š**a åº”è¯¥æ’åœ¨ b å‰é¢**ã€‚

### 1.3 æ¯”è¾ƒå‡½æ•°çš„è¦æ±‚ï¼ˆä¸¥æ ¼å¼±åºï¼‰

è¿™ä¸ªæ˜¯å¾ˆå¤šäººå¿½ç•¥ä½†é¢è¯•çˆ±é—®çš„ç‚¹ï¼š

æ¯”è¾ƒå‡½æ•° `comp` å¿…é¡»æ»¡è¶³ï¼š

- **è‡ªåæ€§**ï¼š`comp(x, x)` å¿…é¡»æ˜¯ `false`
- **ä¼ é€’æ€§**ï¼š`comp(a, b)` && `comp(b, c)` â‡’ `comp(a, c)` å¿…é¡» true
- **ä¸çŸ›ç›¾**ï¼š`comp(a, b)` ä¸ºçœŸæ—¶ï¼Œ`comp(b, a)` å¿…é¡»ä¸ºå‡

æ¯”å¦‚**é”™è¯¯å†™æ³•**ï¼š

```cpp
// æƒ³è®©å¥‡æ•°åœ¨å‰ã€å¶æ•°åœ¨åï¼Œä½†æ²¡è€ƒè™‘å¤§å°é¡ºåº
bool bad_comp(int a, int b) {
    return (a % 2) < (b % 2);  // åªæŒ‰å¥‡å¶æ’ï¼Œä¸ç®¡å¤§å°
}
```

è¿™æ ·ä¼šè®© sort å†…éƒ¨è®¤ä¸ºâ€œæœ‰äº›å…ƒç´ äº’ç›¸æ¯”ä¸å‡ºå¤§å°â€ï¼Œå¯èƒ½è§¦å‘ UBï¼ˆæ¯”å¦‚ `find` æ‰¾ä¸åˆ°åˆšæ’å…¥çš„ï¼Œé¡ºåºä¹±ä¸ƒå…«ç³Ÿï¼‰ã€‚
 å®åŠ¡ä¸­ï¼šæ¯”è¾ƒå‡½æ•°ä¸€èˆ¬æ˜¯ç±»ä¼¼â€œ`if (x != y) return x < y; else return...`â€è¿™ç§ï¼Œå¤©ç„¶æ»¡è¶³ä¸¥æ ¼å¼±åºã€‚

------

### 1.4 å¤æ‚åº¦ & è¿­ä»£å™¨è¦æ±‚

- ç®—æ³•å®ç°ï¼šå¤šæ•°æ ‡å‡†åº“æ˜¯â€œå¿«æ’ + å †æ’/æ’æ’ æ··åˆâ€ï¼Œä»¥ä¿è¯æœ€å O(n log n)ã€‚
- å¤æ‚åº¦ï¼šå¹³å‡ O(n log n)ï¼Œæœ€å O(n log n)ã€‚
- è¿­ä»£å™¨è¦æ±‚ï¼š**RandomAccessIterator**
  - âœ… `vector` / `deque` / `array` / `string`
  - âŒ `list` / `forward_list`
  - âŒ `map` / `unordered_map`ï¼ˆåªèƒ½å…ˆæ‹·è´åˆ° vector å† sortï¼‰

ä¸€å¥è¯å…«è‚¡æ€»ç»“ï¼š

> `std::sort` æ˜¯é€šç”¨æ’åºç®—æ³•ï¼Œè¦æ±‚éšæœºè®¿é—®è¿­ä»£å™¨ï¼Œå¹³å‡ & æœ€åå¤æ‚åº¦éƒ½æ˜¯ O(n log n)ï¼Œé»˜è®¤ç”¨ `<`ï¼Œä¹Ÿå¯ä»¥ä¼ è‡ªå®šä¹‰æ¯”è¾ƒå™¨ï¼Œå¿…é¡»æ»¡è¶³ä¸¥æ ¼å¼±åºã€‚

------

### 1.5 æ‰©å±•ï¼š`std::stable_sort`

`std::stable_sort`ï¼š**ç¨³å®šæ’åº**ï¼Œç›¸ç­‰å…ƒç´ çš„ç›¸å¯¹é¡ºåºä¸å˜ã€‚

ä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ

- å…ˆæŒ‰ key1 æ’ï¼Œå†æŒ‰ key2 æ’
   âœ å¦‚æœç¬¬äºŒæ¬¡æ’åºæ˜¯ç¨³å®šçš„ï¼Œç­‰ä»·äºâ€œä¸» key2 + æ¬¡ key1â€çš„è”åˆæ’åºã€‚

ä¸¾ä¾‹ï¼ˆå…ˆæŒ‰ `from`ï¼ŒåæŒ‰ `slack`ï¼‰ï¼š

```cpp
std::stable_sort(vec.begin(), vec.end(),
                 [](const Edge& a, const Edge& b) {
                     return a.from < b.from; // ç¬¬ä¸€æ¬¡æŒ‰ from æ’
                 });

std::stable_sort(vec.begin(), vec.end(),
                 [](const Edge& a, const Edge& b) {
                     return a.slack < b.slack; // ç¬¬äºŒæ¬¡æŒ‰ slack æ’
                 });
```

æœ€åç»“æœï¼š

- slack è¶Šå°è¶Šé å‰ï¼›
- åŒ slack å…ƒç´ ä¹‹é—´æŒ‰ from å‡åºã€‚

å¤æ‚åº¦ä¹Ÿæ˜¯ O(n log n)ï¼Œä½†å¸¸æ•°æ¯” `sort` å¤§ä¸€äº›ã€‚

------

## 2. `std::reverse` â€”â€” ç®€å•ä½†å¸¸ç”¨

### 2.1 åŸºæœ¬ç”¨æ³•

```cpp
#include <algorithm>
#include <vector>

std::vector<int> v = {1, 2, 3, 4};
std::reverse(v.begin(), v.end()); // v å˜æˆ {4, 3, 2, 1}
```

- æ—¶é—´å¤æ‚åº¦ O(n)
- è¦æ±‚ï¼šè‡³å°‘**åŒå‘è¿­ä»£å™¨**ï¼ˆ`map`ã€`list`ã€`vector` éƒ½å¯ä»¥ï¼‰

### 2.2 å¸¸è§ç»„åˆ

- æ’åºåæƒ³è¦**é™åº**ï¼š

  ```cpp
  std::sort(v.begin(), v.end());      // å‡åº
  std::reverse(v.begin(), v.end());   // å˜æˆé™åº
  ```

  æˆ–è€…ä¸€å¼€å§‹å°±ç”¨ `sort` + æ¯”è¾ƒå™¨é™åºã€‚

- åè½¬å­—ç¬¦ä¸²ï¼š

  ```cpp
  std::string s = "abc";
  std::reverse(s.begin(), s.end());   // "cba"
  ```

------

## 3. `std::lower_bound` / `std::upper_bound` â€”â€” äºŒåˆ†æŸ¥æ‰¾ä¸‰ä»¶å¥—ä¹‹ä¸€

è¿™ä¿©æ˜¯**åœ¨æœ‰åºåŒºé—´ä¸ŠåšäºŒåˆ†æŸ¥æ‰¾**çš„ç®—æ³•ï¼ŒåŸå‹ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š

```cpp
template<class ForwardIt, class T>
ForwardIt lower_bound(ForwardIt first, ForwardIt last, const T& value);

template<class ForwardIt, class T>
ForwardIt upper_bound(ForwardIt first, ForwardIt last, const T& value);
```

å‰ææ¡ä»¶ï¼š

> `[first, last)` å¿…é¡»æ˜¯æŒ‰ç›¸åŒæ¯”è¾ƒè§„åˆ™**æœ‰åº**çš„ï¼Œå¦åˆ™ç»“æœæœªå®šä¹‰ã€‚

### 3.1 lower_boundï¼šç¬¬ä¸€ä¸ª â‰¥ value çš„ä½ç½®

```cpp
std::vector<int> v = {1, 3, 3, 5, 7};
auto it = std::lower_bound(v.begin(), v.end(), 3);
// it æŒ‡å‘ç¬¬ä¸€ä¸ª 3ï¼ˆä¸‹æ ‡ 1ï¼‰
```

- å¦‚æœæ‰€æœ‰å…ƒç´ éƒ½ `< value`ï¼Œåˆ™è¿”å› `last`ã€‚
- æ—¶é—´å¤æ‚åº¦ï¼šO(log n)

### 3.2 upper_boundï¼šç¬¬ä¸€ä¸ª > value çš„ä½ç½®

```cpp
auto it2 = std::upper_bound(v.begin(), v.end(), 3);
// æŒ‡å‘ 5ï¼ˆä¸‹æ ‡ 3ï¼‰
```

é…åˆ `lower_bound`ï¼Œå¯ä»¥å¿«é€Ÿå¾—åˆ°ï¼š

- æ‰€æœ‰ç­‰äº `value` çš„å…ƒç´ åŒºé—´æ˜¯ `[lower_bound, upper_bound)`
- ä¸ªæ•°æ˜¯ `upper_bound - lower_bound`

### 3.3 äºŒåˆ†æŸ¥æ‰¾å¸¸è§å››è¿å‡»ï¼ˆæ‰©å±•ï¼‰

é…å¥—è¿˜æœ‰ä¸¤ä¸ªå…„å¼Ÿï¼š

1. `std::binary_search`ï¼šåªè¿”å›æ˜¯å¦å­˜åœ¨

   ```cpp
   bool exist = std::binary_search(v.begin(), v.end(), 3);
   ```

2. `std::equal_range`ï¼š**ä¸€æ¬¡è¿”å› lower å’Œ upper**

   ```cpp
   auto range = std::equal_range(v.begin(), v.end(), 3);
   auto first = range.first;  // lower_bound
   auto last  = range.second; // upper_bound
   ```

é¢è¯•è¯´æ³•å¯ä»¥è¿™æ ·ï¼š

> äºŒåˆ†æŸ¥æ‰¾ç›¸å…³ç®—æ³•ä¸»è¦æœ‰å››ä¸ªï¼š`lower_bound` è¿”å›ç¬¬ä¸€ä¸ª â‰¥ value çš„ä½ç½®ï¼Œ`upper_bound` è¿”å›ç¬¬ä¸€ä¸ª > value çš„ä½ç½®ï¼Œ`binary_search` åˆ¤æ–­æ˜¯å¦å­˜åœ¨ï¼Œ`equal_range` ä¸€æ¬¡è¿”å› `[lower, upper)` åŒºé—´ï¼›å®ƒä»¬éƒ½è¦æ±‚åŒºé—´æ˜¯æœ‰åºçš„ï¼Œæ—¶é—´å¤æ‚åº¦ O(log n)ã€‚

------

### 3.4 lower_bound çš„å…¸å‹ç”¨æ³•ï¼šä¿æŒæœ‰åºæ’å…¥

å‡è®¾ä½ æœ‰ä¸€ä¸ª**æœ‰åº vector**ï¼Œå¸Œæœ›æ’å…¥æ–°å…ƒç´ æ—¶ä»ä¿æŒæœ‰åºï¼š

```cpp
std::vector<int> v = {1, 3, 5, 7};
int x = 4;

auto it = std::lower_bound(v.begin(), v.end(), x);
v.insert(it, x);  // æ’å…¥ä¹‹å v = {1,3,4,5,7}
```

- `lower_bound` æ‰¾åˆ°ç¬¬ä¸€ä¸ª â‰¥ x çš„ä½ç½®ï¼›
- æ’å…¥åˆ°è¿™é‡Œå³å¯ä¿æŒæœ‰åºã€‚

åœ¨ STA / EDA åœºæ™¯ä¸­ï¼š

> åšæŸ¥è¡¨æ’å€¼ï¼ˆä¾‹å¦‚ç”µå‹ã€æ¸©åº¦ç›¸å…³çš„ delay è¡¨ï¼‰ï¼Œå¸¸ç”¨ lower_bound æ‰¾åˆ°åŒºé—´ `[x_i, x_{i+1})`ï¼Œç„¶ååšæ’å€¼ã€‚

------

## 4. å¸¸ç”¨â€œå¥—è·¯æ‰©å±•â€ï¼š`sort + unique` å»é‡ã€`remove_if` + erase

è™½ç„¶ä½ ç¬”è®°é‡Œæ²¡å†™ï¼Œä½†è¿™ä¸¤ä¸ªç»„åˆé¢è¯•ç‰¹åˆ«å–œæ¬¢é—®ï¼Œé¡ºå¸¦è®°ä¸€ä¸‹ã€‚

### 4.1 sort + unique å»é‡

ç›®æ ‡ï¼šç»™ä¸€ä¸ª vector å»é‡ï¼ˆä¸è¦æ±‚ä¿æŒåŸé¡ºåºï¼‰ï¼š

```cpp
std::vector<int> v = {3, 1, 3, 2, 1};

// 1. æ’åº
std::sort(v.begin(), v.end());  // {1,1,2,3,3}

// 2. unique æŠŠé‡å¤å…ƒç´ â€œæŒ¤åˆ°åé¢â€
auto it = std::unique(v.begin(), v.end()); // {1,2,3,?,?}

// 3. erase åˆ é™¤å°¾éƒ¨å¤šä½™å…ƒç´ 
v.erase(it, v.end());           // {1,2,3}
```

**è®°å¿†ç‚¹**ï¼š

- `std::unique` ä¸æ˜¯çœŸæ­£â€œåˆ å…ƒç´ â€ï¼Œåªæ˜¯æŠŠä¸é‡å¤çš„å…ƒç´ å¾€å‰æŒªï¼Œè¿”å›ä¸€ä¸ªâ€œæ–°é€»è¾‘æœ«å°¾â€çš„è¿­ä»£å™¨ï¼›
- çœŸæ­£åˆ æ‰è¦é…åˆ `erase` â€”â€” è¿™å°±æ˜¯è‘—åçš„ **erase-remove æƒ¯ç”¨æ³•** çš„äº²æˆšã€‚

### 4.2 remove_if + eraseï¼ˆäº†è§£ï¼‰

```cpp
v.erase(std::remove_if(v.begin(), v.end(),
                       [](int x) { return x % 2 == 0; }),
        v.end());
```

- åˆ é™¤æ‰€æœ‰å¶æ•°ï¼›
- åŸå› ç±»ä¼¼ï¼š`remove_if` æŠŠä¸è¦çš„å…ƒç´ æŒ¤åˆ°åé¢ï¼Œå†ç”¨ `erase` ç‰©ç†åˆ é™¤ã€‚

------

## 5. å’Œå…³è”å®¹å™¨çš„å…³ç³»ï¼ˆå®¹æ˜“æ··ï¼‰

ä½ å‰é¢å­¦äº† 3.3 å…³è”å®¹å™¨ï¼Œè¿™é‡Œè¯´æ˜ä¸€ç‚¹ï¼š

- `std::map` / `std::set` è‡ªèº«å°±æœ‰æˆå‘˜å‡½æ•°ï¼š

  ```cpp
  auto it = m.lower_bound(key);
  auto it2 = m.upper_bound(key);
  auto p = m.equal_range(key);
  ```

  è¿™äº›æ˜¯**æ ‘ä¸Šçš„æ“ä½œ**ï¼Œå¤æ‚åº¦ O(log n)ã€‚

- `<algorithm>` é‡Œçš„ `std::lower_bound` / `std::upper_bound` æ˜¯**åŸºäºè¿­ä»£å™¨çš„æ³›å‹ç®—æ³•**ï¼Œä¸»è¦ç”¨åœ¨ `vector` ç­‰çº¿æ€§åºåˆ—ä¸Šã€‚

å¤§å¤šæ•°æƒ…å†µä¸‹ï¼š

- å¯¹ `vector` / `array`ï¼šç”¨ `<algorithm>` ç‰ˆæœ¬ï¼›
- å¯¹ `map` / `set`ï¼šç”¨æˆå‘˜å‡½æ•°ç‰ˆæœ¬ï¼ˆæ›´é«˜æ•ˆï¼Œä¸ç”¨çº¿æ€§æ‰«ï¼‰ã€‚

------

## 6. å°ç»“ï¼šç»™ä½ ä¸€ä¸ªâ€œ3.4 é¢è¯•å£è¿°ç‰ˆâ€

ä½ å¯ä»¥è¯•ç€ç”¨è‡ªå·±çš„è¯å¤è¿°ä¸‹é¢è¿™æ®µï¼ˆè¿™æ˜¯ç»™é¢è¯•å®˜è¯´çš„ç‰ˆæœ¬ï¼‰ï¼š

> STL ç®—æ³•ä¸»è¦é€šè¿‡è¿­ä»£å™¨æ“ä½œåŒºé—´ï¼Œæ¯”å¦‚ `std::sort`ã€`std::reverse` å’Œ `std::lower_bound` / `upper_bound`ã€‚
>
> `std::sort` åœ¨ `<algorithm>` é‡Œï¼Œæ˜¯ä¸€ä¸ªéœ€è¦**éšæœºè®¿é—®è¿­ä»£å™¨**çš„æ’åºç®—æ³•ï¼Œä¸€èˆ¬ç”¨åœ¨ `vector`ã€`deque`ã€`array` ä¸Šï¼Œé»˜è®¤ç”¨ `<` ä»å°åˆ°å¤§æ’ï¼Œå¤æ‚åº¦å¹³å‡å’Œæœ€åéƒ½æ˜¯ O(n log n)ï¼Œä¹Ÿå¯ä»¥ä¼  lambda åšè‡ªå®šä¹‰æ¯”è¾ƒï¼Œæ¯”è¾ƒå‡½æ•°è¦æ»¡è¶³ä¸¥æ ¼å¼±åºã€‚
>
> `std::reverse` æ¯”è¾ƒç®€å•ï¼Œå¯¹ `[first, last)` åšåŸåœ°åè½¬ï¼ŒåŒå‘è¿­ä»£å™¨å°±å¤Ÿäº†ï¼Œå¤æ‚åº¦ O(n)ã€‚å¸¸è§ç”¨æ³•æ˜¯æ’åºåå† reverse åšé™åºï¼Œæˆ–è€…åè½¬å­—ç¬¦ä¸²ã€‚
>
> `std::lower_bound` å’Œ `std::upper_bound` æ˜¯åŸºäºäºŒåˆ†æŸ¥æ‰¾çš„æœç´¢ç®—æ³•ï¼Œå‰ææ˜¯åŒºé—´æŒ‰åŒæ ·çš„æ¯”è¾ƒè§„åˆ™æœ‰åºã€‚`lower_bound` è¿”å›ç¬¬ä¸€ä¸ª â‰¥ value çš„è¿­ä»£å™¨ï¼Œ`upper_bound` è¿”å›ç¬¬ä¸€ä¸ª > value çš„è¿­ä»£å™¨ï¼Œæ—¶é—´å¤æ‚åº¦ O(log n)ï¼Œå¯ä»¥ç”¨æ¥ç»Ÿè®¡å…ƒç´ ä¸ªæ•°ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥åœ¨æœ‰åº vector é‡Œæ‰¾åˆ°æ’å…¥ä½ç½®å¹¶ä¿æŒæœ‰åºã€‚é…å¥—è¿˜æœ‰ `binary_search` å’Œ `equal_range`ã€‚
>
> å®æˆ˜ä»£ç é‡Œå¸¸è§çš„å¥—è·¯æ˜¯ï¼š`sort + unique` åšå»é‡ï¼Œ`remove_if + erase` åšè¿‡æ»¤ï¼Œè¿™äº›éƒ½æ˜¯ `<algorithm>` é‡Œçš„é€šç”¨ç®—æ³•åŠ å®¹å™¨æˆå‘˜å‡½æ•°ç»„åˆèµ·æ¥ç”¨ã€‚

------

å¦‚æœä½ æ„¿æ„ï¼Œä¸‹ä¸€æ­¥å¯ä»¥ï¼š

- ä½ æŒ‘ä¸€ä¸ªä½ æœ€å…³å¿ƒçš„åœºæ™¯ï¼ˆæ¯”å¦‚â€œSTA æŸ¥è¡¨æ’å€¼â€æˆ–â€œè·¯å¾„æŒ‰ slack æ’åºâ€ï¼‰ï¼Œæˆ‘ç»™ä½ å†™ä¸€æ®µå®Œæ•´ç¤ºä¾‹ï¼ŒæŠŠ `sort` + `lower_bound` ä¸€èµ·ç”¨å‡ºæ¥ï¼›
- æˆ–è€…æˆ‘ç»™ä½ å‡ é“â€œ3.4 ç®—æ³• + 3.2 é¡ºåºå®¹å™¨ + 3.3 å…³è”å®¹å™¨â€ç»¼åˆå°é¢˜ï¼Œè®©ä½ ç»ƒä¹ ä¸€ä¸‹ç­”é¢˜å¥—è·¯ã€‚