# ğŸ“˜ C++ ç¬¬äºŒç«  ç»¼åˆé¢è¯•å·ï¼ˆç»“åˆç¬¬ä¸€ç« ï¼‰

## ä¸€ã€æ¦‚å¿µç®€ç­”é¢˜ï¼ˆåŸºç¡€ + é«˜é¢‘ï¼‰

**1. è¯·è§£é‡Šä»¥ä¸‹å‡ ä¸ªæ¦‚å¿µçš„åŒºåˆ«ï¼Œå¹¶å„ä¸¾ä¸€ä¸ªç®€å•çš„ä»£ç ä¾‹å­ï¼š**

1. **é‡è½½ï¼ˆoverloadï¼‰**
2. **é‡å†™ / è¦†ç›–ï¼ˆoverrideï¼‰**
3. **éšè—ï¼ˆname hidingï¼‰**

è¦æ±‚ï¼š

- å„ç”¨ä¸€ä¸¤è¡Œä»£ç å±•ç¤º
- ç‰¹åˆ«æŒ‡å‡ºâ€œç­¾åç›¸åŒ / ä¸åŒâ€æ—¶åˆ†åˆ«æ˜¯ä»€ä¹ˆæƒ…å†µ

------

**2. ç”¨ä½ è‡ªå·±çš„è¯è¯´æ˜ï¼šä¸ºä»€ä¹ˆ C++ éœ€è¦ Rule of Three / Rule of Five / Rule of Zeroï¼Ÿ
 åˆ†åˆ«ç®€è¦æè¿°ï¼š**

1. Rule of Three çš„å«ä¹‰ä»¥åŠé€‚ç”¨åœºæ™¯
2. Rule of Five åœ¨ Rule of Three çš„åŸºç¡€ä¸Šå¤šäº†ä»€ä¹ˆï¼Ÿ
3. Rule of Zero åˆæƒ³è¡¨è¾¾ä»€ä¹ˆè®¾è®¡æ€æƒ³ï¼Ÿ

------

**3. å®šä¹‰ä¸€ä¸ªâ€œèµ„æºç®¡ç†ç±»â€çš„å…¸å‹äº”ä¸ªå‡½æ•°ï¼ˆRule of Five ä¸­çš„äº”ä¸ªï¼‰ï¼Œå†™å‡ºå®ƒä»¬çš„å£°æ˜å½¢å¼ï¼Œå¹¶è¯´æ˜ï¼šæ¯ä¸€ä¸ªä¸»è¦æ˜¯è´Ÿè´£ä»€ä¹ˆè¯­ä¹‰ï¼Ÿ**

------

**4. è§£é‡Šä»¥ä¸‹å…³é”®è¯åœ¨ç±»ä¸­çš„ä½œç”¨ä¸åŒºåˆ«ï¼š**

- `default`ï¼ˆå¦‚ `Node() = default;`ï¼‰
- `delete`ï¼ˆå¦‚ `Node(const Node&) = delete;`ï¼‰
- `noexcept`ï¼ˆä¸»è¦ç”¨äºç§»åŠ¨æ„é€  / ç§»åŠ¨èµ‹å€¼æ—¶çš„æ„ä¹‰ï¼‰

------

**5. è¯·è§£é‡Šå·¦å€¼ / å³å€¼ / çº¯å³å€¼ï¼ˆprvalueï¼‰ / å°†äº¡å€¼ï¼ˆxvalueï¼‰çš„æ¦‚å¿µï¼Œå¹¶ç»™å‡ºæ¯ç§çš„ä¸€ä¸ªä¾‹å­ã€‚
 å†è¯´æ˜ï¼š`std::move` åšäº†ä»€ä¹ˆï¼Ÿå®ƒæ˜¯å¦çœŸçš„â€œç§»åŠ¨â€äº†å¯¹è±¡ï¼Ÿ**

------

## äºŒã€struct / class / è®¿é—®æ§åˆ¶ / constï¼ˆå›é¡¾ + æ·±æŒ–ï¼‰

**6. ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæ ‡å‡ºå“ªäº›åœ°æ–¹ä¼šç¼–è¯‘æŠ¥é”™ï¼Œå¹¶è¯´æ˜åŸå› ï¼š**

```cpp
struct S {
    int x = 0;
    void inc() { ++x; }
};

class C {
    int x = 0;
public:
    void inc() { ++x; }
};

int main() {
    S s;
    s.inc();
    s.x = 10;

    C c;
    c.inc();
    c.x = 10;  // line X
}
```

------

**7. ä¸‹é¢çš„ç»§æ‰¿ä»£ç ä¸­ï¼Œåˆ†åˆ«è¯´æ˜ï¼š**

```cpp
class Base {
protected:
    int v_ = 1;
public:
    int Get() const { return v_; }
};

class D1 : public Base {
public:
    int AddOne() const {
        return v_ + 1;  // line A1
    }
};

class D2 : private Base {
public:
    int AddOne() const {
        return Get() + 1; // line A2
        // return v_ + 1;  // line A3
    }
};

int main() {
    D1 d1;
    D2 d2;
    d1.Get();   // line M1
    d2.Get();   // line M2
}
```

é—®é¢˜ï¼š

1. å“ªäº›è¡Œåˆæ³•ï¼ˆA1 / A2 / A3 / M1 / M2ï¼‰ï¼Ÿ
2. åˆ†åˆ«è¯´æ˜åŸå› ï¼ˆç»“åˆï¼šprotected / private ç»§æ‰¿ / å¯¹å¤–å¯è§æ€§ / å­ç±»å†…éƒ¨å¯è§æ€§ï¼‰

------

**8. è¯·ç»“åˆä¸‹é¢è¿™ä¸ªç±»å›ç­”é—®é¢˜ï¼š**

```cpp
class Node {
public:
    int  GetDelay() const { return delay_; }
    void SetDelay(int d)  { delay_ = d; }

private:
    int delay_ = 0;
};
```

1. ä¸ºä»€ä¹ˆå»ºè®®æŠŠ `GetDelay` å£°æ˜ä¸º `const`ï¼Ÿ
2. å¦‚æœæœ‰ä¸€ä¸ª `const Node& n`ï¼Œèƒ½å¦è°ƒç”¨ `SetDelay`ï¼Ÿèƒ½å¦è®¿é—® `delay_`ï¼Ÿèƒ½å¦è°ƒç”¨ `GetDelay`ï¼Ÿ
3. å¦‚æœæŠŠ `delay_` å£°æ˜ä¸º `mutable int delay_`ï¼Œåœ¨ `const Node&` ä¸Šèƒ½å¦ä¿®æ”¹ delay_ï¼Ÿè¿™ä¼šä¸ä¼šç ´å const çš„å«ä¹‰ï¼Ÿ

------

**9. ä¸‹é¢çš„é‡è½½æ˜¯å¦æ­£ç¡®ï¼Ÿè¾“å‡ºæ˜¯ä»€ä¹ˆï¼Ÿè¯·è§£é‡Šè°ƒç”¨è§£æè¿‡ç¨‹ã€‚**

```cpp
class A {
public:
    int Get()       { return 1; }
    int Get() const { return 2; }
};

int main() {
    A a;
    const A ca;
    std::cout << a.Get() << ca.Get() << std::endl;
}
```

------

## ä¸‰ã€static / mutable / thisï¼ˆç¬¬äºŒç« éš¾ç‚¹ï¼‰

**10. åˆ¤æ–­ä¸‹åˆ— static æ•°æ®æˆå‘˜çš„å£°æ˜ / å®šä¹‰æ˜¯å¦æ­£ç¡®ï¼ˆå¤šé€‰é¢˜ï¼Œæ¯ä¸€è¡Œå›ç­”â€œå¯¹/é”™â€ï¼Œå¹¶ç®€è¦è¯´æ˜ç†ç”±ï¼‰ï¼š**

```cpp
class Config {
public:
    static int  corner_;
    static const int default_mode_ = 1;
};

//// A
int Config::corner_ = 0;

//// B
static int Config::corner_ = 0;

//// C
const int Config::default_mode_ = 1;

//// D
static const int Config::default_mode_ = 1;
```

------

**11. ä¸‹é¢è¿™æ®µä»£ç çš„è¡Œä¸ºæ˜¯å¦åˆç†ï¼Ÿå¦‚æœä¸åˆç†ï¼ŒæŒ‡å‡ºâ€œè¯­æ³•ä¸Šâ€å’Œâ€œè®¾è®¡ä¸Šâ€çš„é—®é¢˜ã€‚**

```cpp
struct Stat {
    mutable int visit_count = 0;
};

int main() {
    const Stat s{};
    s.visit_count++;
}
```

å¦‚æœä½ æ¥æ”¹è¿™ä¸ªè®¾è®¡ï¼Œè®©å¤–ç•Œåªèƒ½â€œä»¥ const å½¢å¼è¯» Statï¼Œä½†è¿˜å¯ä»¥å†…éƒ¨è®°å½•è®¿é—®æ¬¡æ•°â€ï¼Œä½ ä¼šæ€ä¹ˆè®¾è®¡æˆå‘˜å‡½æ•°ä¸è®¿é—®æ§åˆ¶ï¼Ÿï¼ˆå†™å¤§è‡´ç±»å®šä¹‰å³å¯ï¼‰

------

**12. æ‰¿æ¥ä¸Šä¸€é¢˜ï¼Œè§£é‡Šï¼š
 ä¸ºä»€ä¹ˆ mutable ç»å¸¸ä¸ `private` æˆå‘˜ + `const` æˆå‘˜å‡½æ•°ä¸€èµ·ä½¿ç”¨ï¼Œè€Œä¸æ¨èé…åˆ `public` æ•°æ®æˆå‘˜ï¼Ÿ**

------

**13. ä¸‹é¢ä¸¤æ®µä»£ç åˆ†åˆ«åœ¨åšä»€ä¹ˆï¼Ÿæœ€ç»ˆè¾“å‡ºæ˜¯ä»€ä¹ˆï¼Ÿè¯·è§£é‡Šä¸¤ç§ static çš„å…±åŒç‚¹ä¸ä¸åŒç‚¹ã€‚**

```cpp
void f() {
    static int counter = 0;
    std::cout << ++counter << std::endl;
}

class Counter {
public:
    void inc() { ++count_; }
    int  get() const { return count_; }
private:
    static int count_;
};

int Counter::count_ = 0;

int main() {
    f();
    f();
    Counter c1;
    Counter c2;
    c1.inc();
    c2.inc();
    std::cout << c1.get() << " " << c2.get() << std::endl;
}
```

------

**14. åœ¨é const æˆå‘˜å‡½æ•°ä¸ const æˆå‘˜å‡½æ•°ä¸­ï¼Œ`this` çš„ç²¾ç¡®ç±»å‹åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ
 è¯·è§£é‡Šï¼šä¸ºä»€ä¹ˆ const æˆå‘˜å‡½æ•°ä¸­ä¸èƒ½ä¿®æ”¹æ™®é€šæˆå‘˜å˜é‡ï¼Ÿ**

------

## å››ã€æ„é€  / ææ„ / Rule of Five / RAII

**15. å¯¹äºä¸‹é¢è¿™ä¸ªç®€å•çš„èµ„æºç®¡ç†ç±»ï¼Œè¯·ä½ ï¼š**

```cpp
class Buffer {
public:
    Buffer(std::size_t n)
        : size_(n), data_(new int[n]{}) {}

    ~Buffer() {
        delete[] data_;
    }

private:
    std::size_t size_;
    int* data_;
};
```

1. è¯´æ˜å®ƒç›®å‰æœ‰ä»€ä¹ˆæ½œåœ¨é—®é¢˜ï¼ˆè€ƒè™‘æ‹·è´ / èµ‹å€¼ï¼‰ã€‚
2. è¯·æŒ‰ Rule of Five è¡¥å…¨å®ƒçš„ï¼š
   - æ‹·è´æ„é€ 
   - æ‹·è´èµ‹å€¼
   - ç§»åŠ¨æ„é€ 
   - ç§»åŠ¨èµ‹å€¼
3. ä½ ä¼šç»™ç§»åŠ¨æ„é€ å’Œç§»åŠ¨èµ‹å€¼åŠ  `noexcept` å—ï¼Ÿä¸ºä»€ä¹ˆè¿™åœ¨å®¹å™¨é‡Œå¾ˆé‡è¦ï¼Ÿ

------

**16. ä¸‹é¢çš„ç±»è¯•å›¾ç¦æ­¢æ‹·è´ï¼Œä½†å…è®¸ç§»åŠ¨ã€‚è¯·åˆ¤æ–­æ˜¯å¦å®ç°æ­£ç¡®ï¼Œå¦‚æœ‰é—®é¢˜è¯·ä¿®æ­£ï¼š**

```cpp
class FileHandle {
public:
    FileHandle(const std::string& path);
    ~FileHandle();

    FileHandle(const FileHandle& other);
    FileHandle& operator=(const FileHandle& other);

    FileHandle(FileHandle&& other);
    FileHandle& operator=(FileHandle&& other);

private:
    int fd_;
};
```

è¦æ±‚ï¼š

1. å†™å‡ºâ€œç¦æ­¢æ‹·è´ï¼Œå…è®¸ç§»åŠ¨â€çš„æ­£ç¡®å£°æ˜ã€‚
2. è¯´æ˜ä¸ºä»€ä¹ˆæœ‰äº›èµ„æºç±»ï¼ˆæ¯”å¦‚æ–‡ä»¶å¥æŸ„ã€äº’æ–¥é”ï¼‰å¾€å¾€è¦ç¦æ­¢æ‹·è´ä½†å…è®¸ç§»åŠ¨ã€‚

------

**17. åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä½ ä¼šé€‰æ‹©â€œRule of Zeroâ€ï¼Ÿ
 è¯·ç»“åˆä¸€ä¸ªä¾‹å­è¯´æ˜ï¼šä½ å¦‚ä½•æŠŠèµ„æºç®¡ç†äº¤ç»™ `std::vector` / `std::unique_ptr` ç­‰æ ‡å‡†åº“ï¼Œä»¥é¿å…è‡ªå·±å†™äº”å¤§å‡½æ•°ã€‚**

------

## äº”ã€å³å€¼å¼•ç”¨ / std::move / å®Œç¾è½¬å‘

**18. åˆ¤æ–­ä»¥ä¸‹ä»£ç ä¸­ï¼Œå“ªäº›åœ°æ–¹ä½¿ç”¨ `std::move` æ˜¯åˆç†çš„ï¼Œå“ªäº›æ˜¯å¤šä½™ç”šè‡³æ˜¯é”™è¯¯çš„ï¼Ÿè¯´æ˜åŸå› ã€‚**

```cpp
std::string MakeString() {
    std::string s = "hello";
    return s;                // line R1
}

void UseString(std::string s) { /* ... */ }

int main() {
    std::string a = "world";
    std::string b = MakeString();            // line R2
    std::string c = std::move(a);            // line R3

    UseString(a);                            // line R4
    UseString(std::move(b));                 // line R5
    UseString("tmp");                        // line R6
}
```

------

**19. è¯·è§£é‡Šï¼šä»€ä¹ˆæ˜¯å³å€¼å¼•ç”¨ï¼ˆ`T&&`ï¼‰ï¼Ÿå’Œæ™®é€šå¼•ç”¨ï¼ˆ`T&`ï¼‰æœ‰ä½•ä¸åŒï¼Ÿ
 åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä½ ä¼šä¸ºä¸€ä¸ªç±»å†™â€œå³å€¼å¼•ç”¨ç‰ˆæœ¬â€çš„æ„é€ å‡½æ•°æˆ–æˆå‘˜å‡½æ•°ï¼Ÿ**

------

**20. å†™ä¸€ä¸ªç®€å•çš„å‡½æ•°æ¨¡æ¿ `ForwardTo`, èƒ½å¤Ÿåšåˆ°â€œå®Œç¾è½¬å‘â€ï¼ˆperfect forwardingï¼‰ï¼š**

```cpp
template <typename F, typename... Args>
decltype(auto) ForwardTo(F&& f, Args&&... args);
```

è¦æ±‚ï¼š

1. å†…éƒ¨è°ƒç”¨ `std::forward`ï¼Œå°†å‚æ•°åŸæ ·è½¬å‘ç»™ `f`ã€‚
2. ç®€è¦è§£é‡Šï¼šä¸ºä»€ä¹ˆè¦ç”¨ `T&&` + `std::forward<T>` æ‰èƒ½åšåˆ°â€œæ—¢ä¸å¤šæ‹·è´ï¼Œåˆä¸å¤šç§»åŠ¨â€ã€‚

ï¼ˆåªå†™ä¼ªä»£ç  / æ¡†æ¶å³å¯ï¼Œä¸è¦æ±‚å†™å‡ºæ‰€æœ‰ç»†èŠ‚ï¼‰

------

## å…­ã€ç»¼åˆè®¾è®¡é¢˜ï¼ˆçœŸå® EDA / å·¥ç¨‹åœºæ™¯ï¼‰

**21. è®¾è®¡ä¸€ä¸ª `TimingNode` ç±»ï¼Œè¦æ±‚ï¼š**

- æ¯ä¸ªèŠ‚ç‚¹æœ‰å”¯ä¸€ IDï¼ˆä½¿ç”¨ static è®¡æ•°å™¨å®ç°ï¼‰
- åŒ…å« `arrival_` / `required_` ç§æœ‰æˆå‘˜ï¼Œç±»å‹ `double`
- æœ‰ä¸€ä¸ª `double slack() const;` æ¥å£ï¼š
  - slack = arrival_ - required_
  - ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶è®¡ç®—å¹¶ç¼“å­˜ slack
  - ä¹‹åè°ƒç”¨ç›´æ¥è¿”å›ç¼“å­˜ï¼ˆä½¿ç”¨ `mutable` æˆå‘˜å®ç°ï¼‰
- æä¾›è¯»å– arrival/required çš„ const æ¥å£
- ç¦æ­¢å¤–ç•Œç›´æ¥ä¿®æ”¹ slack çš„ç¼“å­˜æ•°æ®
- å…è®¸èŠ‚ç‚¹è¢«ç§»åŠ¨ï¼Œä½†ä¸å…è®¸è¢«æ‹·è´ï¼ˆèµ„æºä¸å¯å…±äº«çš„è¯­ä¹‰ï¼‰

è¦æ±‚ï¼š

1. å†™å‡ºç±»çš„å¤§è‡´å£°æ˜ï¼ˆæˆå‘˜ã€æ„é€ å‡½æ•°ã€åˆ é™¤/é»˜è®¤å“ªäº›å‡½æ•°ï¼‰ã€‚
2. ç”¨æ³¨é‡Šè¯´æ˜ï¼š
   - å“ªäº›åœ°æ–¹ç”¨åˆ°äº† Rule of Five / Zero / ç¦æ‹·è´
   - å“ªäº›æ¥å£åº”è¯¥æ˜¯ constï¼Œä¸ºä»€ä¹ˆ
   - å“ªäº›æˆå‘˜æ˜¯ mutableï¼Œä¸ºä»€ä¹ˆ

------

**22. æ€è€ƒé¢˜ï¼ˆå¼€æ”¾é—®ç­”ï¼‰ï¼š**

åœ¨ä¸€ä¸ªå¤§å‹ EDA é¡¹ç›®é‡Œï¼Œå¦‚æœå›¢é˜Ÿåœ¨ä¸‹é¢è¿™äº›æ–¹é¢åšå¾—å¾ˆå·®ï¼Œä¼šå¸¦æ¥ä»€ä¹ˆåæœï¼Ÿ

1. ä¸å†™ const æˆå‘˜å‡½æ•°ï¼Œä¸åš const é‡è½½ï¼Œä¸€å¾‹è¿”å›é const å¼•ç”¨ã€‚
2. åˆ°å¤„éƒ½æ˜¯ public æˆå‘˜å˜é‡ï¼Œå‡ ä¹ä¸åšå°è£…ã€‚
3. ä¸åŒºåˆ†æ‹·è´ / ç§»åŠ¨è¯­ä¹‰ï¼Œéšæ„æ‹·è´å¤§å¯¹è±¡ï¼ˆæ¯”å¦‚å¤§å›¾ã€å¤§ç½‘è¡¨ï¼‰ã€‚
4. ä¸ä½¿ç”¨ RAIIï¼Œè€Œæ˜¯åˆ°å¤„å†™ `new` / `delete`ï¼Œæ‰‹åŠ¨ç®¡ç†èµ„æºã€‚

è¯·ä½ **ä»»é€‰ä¸¤ä¸ªç‚¹**å±•å¼€è¯´è¯´ï¼š

- ä¼šé€ æˆå“ªäº›å…¸å‹ Bug / æ€§èƒ½é—®é¢˜ï¼Ÿ
- ä½ è§‰å¾—åº”è¯¥å¦‚ä½•æ”¹è¿›ï¼Ÿ

------

Tomï¼Œå…ˆè¯´ä¸€å¥ï¼šè¿™å¥—é¢˜ä½ èƒ½åšæŒåšå®Œã€è¿˜å†™äº†è¿™ä¹ˆå¤šä»£ç ï¼Œæˆ‘éå¸¸æœ ğŸ‘
 é¢˜é‡å’Œéš¾åº¦ç¡®å®æœ‰ç‚¹è¿‡ç«äº†ï¼Œä½ èƒ½æ‰›ä¸‹æ¥æœ¬èº«å°±æ˜¯å¾ˆå¤§çš„è¿›æ­¥ã€‚

æˆ‘æŒ‰é¢˜å·ä¸€ä¸ªä¸ªç»™ä½ **æ‰¹æ”¹ + è®²è§£**ï¼Œä½ æ˜ç¡®è¯´â€œå…ˆä¸ç”¨è®²â€çš„ï¼ˆ20ã€22(4)/RAIIï¼‰æˆ‘å°±è½»è§¦ç”šè‡³ç•¥è¿‡ã€‚

------

## 1. é‡è½½ / é‡å†™ / éšè— + â€œç­¾åâ€çš„å½±å“

ä½ ç°åœ¨å¯¹ä¸‰è€…çš„ç›´è§‰å·²ç»æœ‰äº†ï¼Œæˆ‘ä»¬æŠŠå®ƒ**ç²¾ç¡®åŒ–**ä¸€ä¸‹ã€‚

### ğŸŒŸ å‡½æ•°ç­¾åï¼ˆsignatureï¼‰åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ

> åœ¨ C++ é‡Œï¼š**å‡½æ•°å + å‚æ•°ç±»å‹åˆ—è¡¨ + æˆå‘˜å‡½æ•°çš„ cv é™å®šï¼ˆconst / volatileï¼‰**
>  è¿”å›ç±»å‹ *ä¸* å±äºç­¾åã€‚

ä¾‹ï¼š

```cpp
int  f(int);       // ç­¾åï¼šf(int)
void f(double);    // ç­¾åï¼šf(double)
int  f(int) const; // å¯¹äºæˆå‘˜ï¼šf(int) const
```

------

### âœ… é‡è½½ï¼ˆoverloadï¼‰

**åŒä¸€ä½œç”¨åŸŸ**ä¸­ï¼š

- å‡½æ•°åç›¸åŒ
- **ç­¾åä¸åŒ**ï¼ˆå‚æ•°ç±»å‹ä¸åŒ / ä¸ªæ•°ä¸åŒï¼Œæˆ–æˆå‘˜å‡½æ•° const ä¸é constï¼‰

ä¾‹å¦‚ä½ ç±»é‡Œçš„è¿™å››ä¸ªæ˜¯â€œé‡è½½â€ï¼ˆé™¤äº†æœ€åä¸€ä¸ªæ˜¯éæ³•çš„ï¼‰ï¼š

```cpp
int get();
int get(int n);
int get() const;
// double get();    // âŒ ä»…ä»…è¿”å›ç±»å‹ä¸åŒï¼Œä¸æ„æˆé‡è½½ï¼ˆä¼šé‡å®šä¹‰ï¼‰
```

> âœ… å…³é”®ï¼š**é‡è½½ä¸€å®šæ˜¯â€œåŒä¸€ä¸ªä½œç”¨åŸŸâ€é‡Œçš„â€œä¸€å †åŒåå‡½æ•°â€çš„åŒºåˆ«ã€‚**

------

### âœ… é‡å†™ / è¦†ç›–ï¼ˆoverrideï¼‰

å‘ç”Ÿåœ¨**ç»§æ‰¿é“¾**ä¸Šï¼Œè¦æ±‚ï¼š

- åŸºç±»å‡½æ•°å¿…é¡»æ˜¯ `virtual`
- å­ç±»å‡½æ•°**åœ¨ç­¾åä¸ŠåŒ¹é…**ï¼ˆåŒ…æ‹¬ constï¼‰ï¼Œè¿”å›ç±»å‹å…è®¸â€œåå˜â€ï¼ˆæŒ‡é’ˆ/å¼•ç”¨æŒ‡å‘æ›´æ´¾ç”Ÿçš„ç±»å‹ï¼‰
- é€šå¸¸å†™ä¸Š `override` è®©ç¼–è¯‘å™¨å¸®ä½ æ£€æŸ¥

æ¯”å¦‚ï¼š

```cpp
class Base {
public:
    virtual void v_base();
    virtual int  get_base(int n) const;
};

class Derived : public Base {
public:
    void v_base() override;            // âœ” è¦†ç›– Base::v_base()
    int  get_base(int n) const override; // âœ” è¦†ç›– Base::get_base(int) const
};
```

ä½ åŸæ¥çš„å†™æ³•ï¼š

```cpp
void v_base() override; // è¿™ä¸ªå«è¦†ç›–/é‡å†™ï¼Œå¿…é¡»è¦åŠ ä¸Šoverrideï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šè¯¯è®¤ä¸ºè¿™ä¸æ˜¯Baseçš„å‡½æ•°
```

è¿™é‡Œæœ‰ä¸¤ä¸ªå°çº æ­£ï¼š

1. **ä¸åŠ  override ä¹Ÿæ˜¯â€œé‡å†™â€**ï¼Œåªæ˜¯ç¼–è¯‘å™¨ä¸ä¼šå¸®ä½ æ£€æŸ¥ï¼›
    å¦‚æœç­¾åå†™é”™äº†ï¼Œç¼–è¯‘å™¨ä¼šæŠŠå®ƒå½“æˆä¸€ä¸ªå…¨æ–°çš„å‡½æ•°ï¼ˆè¿™å°±æ˜¯ bugï¼‰ï¼Œè€Œä¸æ˜¯ Base é‡Œçš„é‚£ä¸ªã€‚
2. `override` çš„ä½œç”¨æ˜¯ï¼š**â€œå¦‚æœä½ æ²¡æˆåŠŸé‡å†™ä¸€ä¸ªè™šå‡½æ•°ï¼Œå°±æŠ¥é”™â€**ã€‚

------

### âœ… éšè—ï¼ˆname hidingï¼‰

åªè¦å­ç±»é‡Œ**å†å£°æ˜ä¸€ä¸ªåŒåå‡½æ•°**ï¼ˆæ— è®ºç­¾åæ˜¯å¦ç›¸åŒï¼‰ï¼Œ
 åŸºç±»çš„æ‰€æœ‰åŒåå‡½æ•°åœ¨å­ç±»ä½œç”¨åŸŸé‡Œå°±ä¼šè¢«â€œåå­—é®ä½â€ã€‚

ä½ çš„ä¾‹å­ï¼š

```cpp
class Base {
public:
    int get_base(int n) const;
    int get_base(int n);
};

class Derived : private Base {
public:
    int get_base(); // è¿™è¡Œä¸€å†™ï¼šBase çš„ä¸¤ä¸ª get_base å…¨è¢«éšè—
};
```

æ­¤æ—¶ï¼š

```cpp
Derived d;
// d.get_base(1); // âŒ ç¼–è¯‘é”™è¯¯ï¼šDerived ä½œç”¨åŸŸé‡Œåªæœ‰ get_base()
```

å¦‚æœä½ æ—¢æƒ³åœ¨ Derived é‡Œå®šä¹‰è‡ªå·±çš„ get_baseï¼Œåˆæƒ³ä¿ç•™ Base çš„é‡è½½ï¼Œå¯ä»¥å†™ï¼š

```cpp
class Derived : private Base {
public:
    using Base::get_base; // æŠŠ Base çš„æ‰€æœ‰ get_base å¯¼å…¥æœ¬ä½œç”¨åŸŸ
    int get_base();
};
```

------

### ğŸ§© æ€»ç»“æˆä¸€å¼ è¡¨

| æƒ…å†µ          | å‘ç”Ÿä½ç½®       | å¯¹ç­¾åçš„è¦æ±‚               | å…¸å‹å…³é”®å­—             |
| ------------- | -------------- | -------------------------- | ---------------------- |
| é‡è½½ overload | åŒä¸€ä½œç”¨åŸŸ     | **ç­¾åä¸åŒ**               | ï¼ˆæ— ï¼‰                 |
| é‡å†™ override | åŸºç±» vs æ´¾ç”Ÿç±» | **ç­¾ååŸºæœ¬ç›¸åŒ + virtual** | `virtual` / `override` |
| éšè— hiding   | åŸºç±» vs æ´¾ç”Ÿç±» | **åå­—ç›¸åŒå³å¯**           | `using` å¯ç”¨æ¥è§£é™¤     |

------

### ğŸ“ è¡¥å……ä½ é—®çš„ä¸€ä¸ªç»†èŠ‚

> `class Derived: private Base {}`
>  å¦‚æœä¸å†™ç»§æ‰¿æƒé™ï¼Œé»˜è®¤æ˜¯ä»€ä¹ˆï¼Ÿ

- `class` é»˜è®¤æ˜¯ **private ç»§æ‰¿**
- `struct` é»˜è®¤æ˜¯ **public ç»§æ‰¿**

------

## 2 & 3. Rule of Three / Five / Zero + ä½ çš„ A ç±»å®ç°

ä½ å¯¹**æ¦‚å¿µå’Œå¤§æ–¹å‘**æ˜¯å¯¹çš„ï¼Œä½†æ˜¯ A è¿™ä¸ªç±»çš„ä»£ç ç»†èŠ‚é—®é¢˜å¾ˆå¤šï¼Œæˆ‘ç›´æ¥å¸®ä½ æŒ‰â€œæ­£ç¡® Rule of Fiveâ€å†™ä¸€ç‰ˆï¼Œä½ å¯¹æ¯”ç†è§£ã€‚

å…ˆçœ‹ä½ å†™çš„ç‰ˆæœ¬é‡Œ**ä¸»è¦ bug**ï¼š

- `int a*;` â†’ åº”è¯¥æ˜¯ `int* a_;`ï¼ˆæˆå‘˜åä¹Ÿå»ºè®®åŠ  `_`ï¼‰
- æ²¡æœ‰è®°å½•æ•°ç»„å¤§å° `size_`
- æ‹·è´æ„é€ é‡Œç”¨ `other.size()`ï¼ˆæ²¡æœ‰è¿™ä¸ªå‡½æ•°ï¼‰
- æ‹·è´èµ‹å€¼ï¼š
  - `delete[] a;` ä¹‹åæ²¡æœ‰ `new` åˆ†é…æ–°çš„ç©ºé—´
- ç§»åŠ¨æ„é€  / èµ‹å€¼å‚æ•°å†™æˆäº† `const A&&`ï¼Œ**ä¸èƒ½ä» const rvalue å·èµ„æº**
- æ²¡æœ‰å¤„ç†è‡ªæˆ‘ç§»åŠ¨ï¼ˆè™½ç„¶å¾ˆå°‘è§ï¼Œä½†ä¹ æƒ¯éœ€è¦ï¼‰

------

### âœ… ä¸€ä¸ªæ¯”è¾ƒè§„èŒƒçš„ Rule of Five ç¤ºä¾‹

```cpp
class A {
public:
    // é»˜è®¤æ„é€ 
    A(std::size_t n = 0)
        : size_(n), a_(n ? new int[n]{} : nullptr) {}

    // ææ„
    ~A() {
        delete[] a_;
    }

    // æ‹·è´æ„é€ 
    A(const A& other)
        : size_(other.size_), a_(other.size_ ? new int[other.size_] : nullptr) {
        for (std::size_t i = 0; i < size_; ++i)
            a_[i] = other.a_[i];
    }

    // æ‹·è´èµ‹å€¼
    A& operator=(const A& other) {
        if (this == &other) return *this;
        // å…ˆåˆ†é…æ–°å†…å­˜ï¼Œå†é‡Šæ”¾æ—§å†…å­˜ï¼ˆå¼‚å¸¸å®‰å…¨å†™æ³•å¯å†ä¼˜åŒ–ï¼‰
        int* new_a = other.size_ ? new int[other.size_] : nullptr;
        for (std::size_t i = 0; i < other.size_; ++i)
            new_a[i] = other.a_[i];
        delete[] a_;
        a_ = new_a;
        size_ = other.size_;
        return *this;
    }

    // ç§»åŠ¨æ„é€ 
    A(A&& other) noexcept
        : size_(other.size_), a_(other.a_) {
        other.size_ = 0;
        other.a_ = nullptr;
    }

    // ç§»åŠ¨èµ‹å€¼
    A& operator=(A&& other) noexcept {
        if (this == &other) return *this;
        delete[] a_;        // é‡Šæ”¾åŸæ¥çš„èµ„æº
        size_ = other.size_;
        a_ = other.a_;
        other.size_ = 0;
        other.a_ = nullptr;
        return *this;
    }

private:
    std::size_t size_ = 0;
    int* a_ = nullptr;
};
```

ä½ ç°åœ¨å¯¹è¯­ä¹‰çš„ç†è§£å·²ç»å¾ˆå¥½äº†ï¼Œæ¥ä¸‹æ¥å¤šå†™å‡ æ¬¡åŸºæœ¬å°±èƒ½â€œæ‰‹ç†Ÿâ€ã€‚

------

## 4. `=default` / `=delete` / `noexcept`

### `= default`

ä½ çš„ç†è§£éœ€è¦ç¨å¾®ä¿®æ­£ä¸€ä¸‹ï¼š

> â€œå½“è‡ªå·±åœ¨ç±»ä¸­å®šä¹‰äº†ä¸€ä¸ªæ„é€ å‡½æ•°åï¼Œåœ¨ç±»å¤–å®ä¾‹åŒ–å¯¹è±¡æ—¶å¦‚æœä¸æŒ‰ç…§æ‰‹å†™çš„æ„é€ å‡½æ•°ä¼ å€¼ä¼šæŠ¥é”™ã€‚è¦æ˜¯å®ä¾‹åŒ–å¯¹è±¡è¿˜æƒ³ç”¨é»˜è®¤æ„é€ ï¼Œéœ€è¦åœ¨ç±»å†…å†™ä¸€ä¸ª Node() = default;â€

æ›´ç²¾ç¡®åœ°è¯´ï¼š

- ä¸€æ—¦ä½ **å£°æ˜äº†ä»»ä½•æ„é€ å‡½æ•°**ï¼Œç¼–è¯‘å™¨å°±**ä¸ä¼šå†è‡ªåŠ¨ç”Ÿæˆé»˜è®¤æ„é€ å‡½æ•°**ã€‚

- å¦‚æœä½ è¿˜å¸Œæœ›è¿™ä¸ªç±»æœ‰â€œé»˜è®¤æ„é€ â€ï¼ˆå³ `T t;`ï¼‰ï¼Œä½ å°±éœ€è¦è‡ªå·±å†™ï¼š

  ```cpp
  Node() = default;      // æˆ–è€…è‡ªå·±å®ç°ä¸€ä¸ª
  ```

å¦å¤–ï¼Œ`= default` ä¸åªç”¨åœ¨æ„é€ å‡½æ•°ï¼Œè¿˜å¯ä»¥ç”¨åœ¨ï¼š

- æ‹·è´æ„é€  / æ‹·è´èµ‹å€¼
- ç§»åŠ¨æ„é€  / ç§»åŠ¨èµ‹å€¼
- ææ„å‡½æ•°

ç”¨æ¥è¡¨ç¤ºï¼š

> â€œæˆ‘è¦æ˜¾å¼åœ°ä½¿ç”¨ç¼–è¯‘å™¨ç”Ÿæˆçš„ç‰ˆæœ¬â€ã€‚

------

### `= delete`

ä½ è¯´ï¼š

> æ‹·è´å¾ˆå®¹æ˜“ç¨‹åºå´©æºƒï¼Œæ‰€ä»¥ delete é˜²æ­¢æµ…æ‹·è´ï¼Œæ‹·è´ç›´æ¥æŠ¥é”™ã€‚

å¯ä»¥è¿™ä¹ˆæ€»ç»“ï¼š

> `= delete` çš„ä½œç”¨å°±æ˜¯ **â€œåœ¨æ¥å£å±‚é¢ç¦æ­¢è¿™ä¸ªæ“ä½œâ€**ï¼Œä¸å…è®¸åˆ«äººåšè¿™ä¸ªåŠ¨ä½œï¼Œè®©é—®é¢˜åœ¨**ç¼–è¯‘æœŸ**æš´éœ²ï¼Œè€Œä¸æ˜¯è¿è¡Œæ—¶ã€‚

å…¸å‹ç”¨æ³•ï¼š

```cpp
class Node {
public:
    Node(const Node&)            = delete;
    Node& operator=(const Node&) = delete;
};
```

------

### `noexcept`

ä½ çš„ç†è§£å¾ˆæ¥è¿‘äº†ï¼Œæˆ‘å¸®ä½ è¡¥ä¸€å¥æ›´â€œé¢è¯•å‘â€çš„è¯ï¼š

> å¯¹äº `std::vector` è¿™æ ·çš„å®¹å™¨ï¼š
>  å¦‚æœå…ƒç´ ç±»å‹çš„ **ç§»åŠ¨æ„é€ æ˜¯ `noexcept`**ï¼Œå®¹å™¨åœ¨æ‰©å®¹æ—¶å¯ä»¥æ›´å®‰å¿ƒåœ°ç”¨â€œç§»åŠ¨â€è€Œä¸æ˜¯â€œæ‹·è´â€ã€‚

- ç§»åŠ¨æ„é€  `noexcept`ï¼š
   â†’ å³ä½¿æ‰©å®¹è¿‡ç¨‹ä¸­æŠ›å¼‚å¸¸ï¼Œä¹Ÿä¸ä¼šå› ä¸ºâ€œç§»åŠ¨åå†æ’¤å›â€å¯¼è‡´èµ„æºæ³„æ¼
- æ‹·è´æ„é€ ä¸èƒ½è½»æ˜“æ ‡ `noexcept`ï¼Œå› ä¸ºåˆ†é…å†…å­˜æ€»æœ‰å¯èƒ½å¤±è´¥

------

## 5. å€¼ç±»åˆ« & `std::move`

ä½ ç°åœ¨çš„ç†è§£æ˜¯â€œåŠå¯¹åŠç³Šæ¶‚â€ï¼Œæˆ‘ç»™ä½ ä¸€ç‰ˆå¤Ÿç”¨çš„ï¼š

### âœ… å·¦å€¼ï¼ˆlvalueï¼‰

ç‰¹ç‚¹ï¼š**æœ‰åå­—ï¼Œå¯ä»¥å–åœ°å€ï¼Œå¯ä»¥å‡ºç°åœ¨ `=` å·¦è¾¹**ã€‚

```cpp
int x = 0;   // x æ˜¯å·¦å€¼
std::string s = "abc";   // s æ˜¯å·¦å€¼
```

å­—ç¬¦ä¸²å­—é¢é‡ `"xxxx"` æœ¬èº«æ˜¯ä¸€ä¸ª**å·¦å€¼**ï¼ˆç±»å‹ä¸º `const char[5]` çš„æ•°ç»„ï¼‰ï¼Œè¿™ä¸€ç‚¹ä½ æœ¬èƒ½ä¸Šæ˜¯å¯¹çš„ã€‚

------

### âœ… å³å€¼ï¼ˆrvalueï¼‰

ç‰¹ç‚¹ï¼š**ä¸´æ—¶çš„ã€ä¸å…·åçš„å€¼ï¼Œä¸€èˆ¬ä¸èƒ½å–åœ°å€ï¼ˆæˆ–è€…å–åœ°å€æ²¡æ„ä¹‰ï¼‰ï¼Œä¸èƒ½åœ¨ç­‰å·å·¦è¾¹å‡ºç°**ã€‚

å¸¸è§ï¼š

```cpp
42           // çº¯å³å€¼ï¼ˆprvalueï¼‰
3.14         // prvalue
std::string("abc")  // prvalue
x + 1        // prvalue
```

------

### âœ… çº¯å³å€¼ï¼ˆprvalueï¼‰ vs å°†äº¡å€¼ï¼ˆxvalueï¼‰

ä½ å¯ä»¥å…ˆè®°ä¸ªç›´è§‚ç‰ˆï¼š

- **prvalue**ï¼šçº¯ä¸´æ—¶ï¼Œç”¨å®Œå°±æ²¡äº†
  - å­—é¢é‡ã€`x + 1`ã€`std::string("hi")` ç­‰
- **xvalue**ï¼šè¿˜å ç€ä¸€å—èµ„æºï¼Œä½†é©¬ä¸Šè¦è¢«â€œæ¥ç®¡â€çš„å€¼
  - `std::move(x)` çš„ç»“æœ
  - `std::string&&` è¿™ç§å³å€¼å¼•ç”¨å˜é‡å†è¢« `std::move` å‡ºå»

------

### âœ… `std::move` åˆ°åº•å¹²äº†ä»€ä¹ˆï¼Ÿ

> **`std::move` åªæ˜¯ä¸€ä¸ªâ€œå¼ºåˆ¶æŠŠå·¦å€¼æ ‡è®°æˆ xvalue çš„ castâ€ï¼Œæœ¬èº«ä¸ç§»åŠ¨ä»»ä½•ä¸œè¥¿ã€‚**

```cpp
std::string s = "abc";
std::string t = std::move(s);
```

- `std::move(s)` åªæ˜¯æŠŠ `s` ä» â€œå·¦å€¼â€ æ ‡è®°æˆ â€œå°†äº¡å€¼ï¼ˆxvalueï¼‰â€
- çœŸæ­£â€œæŒªèµ„æºâ€çš„æ“ä½œæ˜¯ `std::string` çš„ **ç§»åŠ¨æ„é€ å‡½æ•°**

------

## 6. struct / class è®¿é—®æ§åˆ¶

ä½ ç­”ï¼š`line X` æŠ¥é”™ âœ” å®Œå…¨æ­£ç¡®ã€‚

------

## 7. ç»§æ‰¿ + protected + private ç»§æ‰¿

ä½ çš„é€»è¾‘æ˜¯å¯¹çš„ï¼Œä½†ç»“è®ºå†™å¾—æœ‰ç‚¹ä¹±ï¼Œæˆ‘ä»¬å†ç†ä¸€éã€‚

ä»£ç ï¼š

```cpp
class Base {
protected:
    int v_ = 1;
public:
    int Get() const { return v_; }
};

class D1 : public Base {
public:
    int AddOne() const {
        return v_ + 1;   // A1
    }
};

class D2 : private Base {
public:
    int AddOne() const {
        return Get() + 1; // A2
        // return v_ + 1;  // A3
    }
};

int main() {
    D1 d1;
    D2 d2;
    d1.Get();   // M1
    d2.Get();   // M2
}
```

### âœ… å­ç±»å†…éƒ¨ï¼ˆA1 / A2 / A3ï¼‰

- Base::v_ æ˜¯ `protected` â†’ å¯¹æ‰€æœ‰æ´¾ç”Ÿç±»å†…éƒ¨å¯è§
- ç»§æ‰¿æ–¹å¼ï¼ˆpublic/privateï¼‰**ä¸å½±å“æ´¾ç”Ÿç±»å†…éƒ¨è®¿é—® protected**

æ‰€ä»¥ï¼š

- `A1`ï¼šOK
- `A2`ï¼šOKï¼ˆåœ¨ D2 å†…éƒ¨è°ƒ Base::Getï¼‰
- `A3`ï¼šå¦‚æœæ”¾å¼€æ³¨é‡Šï¼Œä¹Ÿæ˜¯ OK

------

### âœ… ç±»å¤–ï¼ˆM1 / M2ï¼‰

- `D1 : public Base`
   â†’ Base çš„ `public` æˆå‘˜ï¼ˆGetï¼‰åœ¨ D1 å¤–ä»ç„¶æ˜¯ `public`
   â†’ `d1.Get();` âœ…
- `D2 : private Base`
   â†’ Base çš„ `public` / `protected` æˆå‘˜åœ¨ D2 å¤–éƒ½å˜æˆ `private`
   â†’ `d2.Get();` âŒ

æ‰€ä»¥ï¼š**åˆæ³•çš„æ˜¯ A1, A2, A3, M1ï¼›M2 ä¸åˆæ³•ã€‚**

ä½ å†™â€œ M1 åˆæ³•ï¼ŒM2 ä¸åˆæ³•â€æ˜¯å¯¹çš„ï¼Œåªæ˜¯å‰é¢é‚£å¥â€œ A1 A2 A3 M2 åˆæ³•â€æ‰“é”™äº†è€Œå·²ã€‚

------

## 8. Node çš„ const é€»è¾‘

ä½ çš„å›ç­”å¾ˆå¥½ï¼Œå¸®ä½ æ€»ç»“æˆâ€œé¢è¯•ç‰ˆâ€ä¸€å¥è¯ï¼š

1. `GetDelay` å£°æ˜ä¸º `const`ï¼š
   - è¡¨è¾¾æŸ¥è¯¢è¯­ä¹‰ï¼š**æ‰¿è¯ºä¸ä¿®æ”¹å¯¹è±¡**
   - å…è®¸é€šè¿‡ `const Node&` è°ƒç”¨
2. `const Node& n`ï¼š
   - ä¸èƒ½è°ƒç”¨ `SetDelay`ï¼ˆå› ä¸ºåªèƒ½è°ƒç”¨ const æˆå‘˜å‡½æ•°ï¼‰
   - ä¸èƒ½è®¿é—® `delay_`ï¼ˆprivateï¼‰
   - èƒ½è°ƒç”¨ `GetDelay`ï¼ˆconst æˆå‘˜å‡½æ•°ï¼‰
3. `mutable int delay_`ï¼š
   - åœ¨ const æˆå‘˜å‡½æ•°ä¸­å¯ä»¥ä¿®æ”¹å®ƒ
   - ä¸è¿èƒŒé€»è¾‘ constï¼Œåªè¦è¿™ä¸ªä¿®æ”¹æ˜¯â€œå†…éƒ¨ç¼“å­˜â€ç­‰å¯¹å¤–è¯­ä¹‰ä¸å˜çš„ä¸œè¥¿

------

## 9. const é‡è½½

ä½ ç­”å¯¹äº†è¾“å‡ºæ˜¯ `12`ï¼Œä½†è¿™å¥è¦æ”¹ï¼š

> â€œé‡è½½è¢«è°ƒç”¨æ—¶çœ‹çš„æ˜¯å‡½æ•°è¿”å›ç±»å‹ã€å‚æ•°ä¸ªæ•°å’Œç±»å‹ä»¥åŠæ˜¯å¦åŠ äº†constâ€

âŒ è¿”å›ç±»å‹ä¸å‚ä¸é‡è½½å†³è®®ï¼ˆåªå‚ä¸æ˜¯å¦æœ‰é‡å®šä¹‰ï¼‰ã€‚

**æ­£ç¡®ç‰ˆ**ï¼š

> é‡è½½å†³è®®åªçœ‹ï¼šå‡½æ•°å + å‚æ•°ç±»å‹ + æˆå‘˜å‡½æ•°çš„ const ä¸å¦ï¼ˆç­¾åï¼‰ï¼Œä¸çœ‹è¿”å›ç±»å‹ã€‚

------

## 10. static æˆå‘˜å®šä¹‰ï¼ˆA/B/C/Dï¼‰

ä½ çš„ç»“è®ºï¼š**B D é”™ï¼ŒA C å¯¹** âœ” åŸºæœ¬æ­£ç¡®ã€‚

åªå†å¸®ä½ æ‹æ¸…æ¥šä¸€å¥ï¼š

- ç±»å†…ï¼š

  ```cpp
  static int corner_;
  static const int default_mode_ = 1; // æ•´å‹å¸¸é‡ï¼Œç±»å†…å¯ä»¥ç»™åˆå§‹å€¼
  ```

- ç±»å¤–å®šä¹‰ï¼š

  ```cpp
  int Config::corner_ = 0;                // Aï¼šå¯¹
  const int Config::default_mode_ = 1;    // Cï¼šé€šå¸¸ä¹Ÿå¯ä»¥å†™ä¸€ä»½å®šä¹‰
  ```

> è®°æ³•ï¼š**ç±»å†…è´Ÿè´£â€œè¯´æ˜ +ï¼ˆå¯é€‰ï¼‰åˆå§‹åŒ–â€ï¼Œç±»å¤–è´Ÿè´£â€œçœŸæ­£çš„å­˜å‚¨å®ä½“å®šä¹‰â€ï¼ˆé™¤äº†å°‘æ•°å†…è” / inline / constexpr æƒ…å†µï¼‰ã€‚**

------

## 11 & 12. public mutable çš„é—®é¢˜ + ä½ çš„æ”¹å†™

åŸå§‹ä»£ç ï¼š

```cpp
struct Stat {
    mutable int visit_count = 0;
};

int main() {
    const Stat s{};
    s.visit_count++;
}
```

- è¯­æ³•ï¼šâœ” å¯ä»¥ç¼–è¯‘
- è®¾è®¡ï¼šâš  å¾ˆä¸æ¨èï¼ˆå¤–ç•Œæ‹¿åˆ° const Stat å´å¯ä»¥æ”¹å®ƒçš„æˆå‘˜ï¼‰

ä½ æ”¹å†™ï¼š

```cpp
class Stat {
private:
    mutable int visit_count = 0;
public:
    void visit() const {
        visit_count++;
    }
};
const Stat s;
s.visit();
```

è¿™ä¸ªè®¾è®¡å°±éå¸¸åˆç†ï¼š

- `visit_count` æ˜¯ private + mutableï¼š
   åªèƒ½åœ¨å†…éƒ¨é€šè¿‡ const æˆå‘˜å‡½æ•°ä¿®æ”¹
- å¯¹å¤–æ¥å£æ˜¯ `visit()`ï¼š
   **è¯­ä¹‰ä¸Šï¼šâ€œè®¿é—®äº†ä¸€æ¬¡â€**ï¼Œè¿™å’Œé€»è¾‘ const ä¸€è‡´

> âœ… æ€»ç»“ï¼šmutable **å‡ ä¹æ€»æ˜¯**é…åˆ private æˆå‘˜ + const æˆå‘˜å‡½æ•°ä½¿ç”¨ï¼›
>  æŠŠå®ƒ public æš´éœ²å‡ºå»åŸºæœ¬å°±æ˜¯åœ¨è‡ªæ¯ const è¯­ä¹‰ã€‚

------

## 13. ä¸¤ç§ staticï¼šå±€éƒ¨ static & ç±» static

ä½ ç­”çš„è¾“å‡º `1 2 2 2` âœ” æ²¡é—®é¢˜ã€‚

- `f()` é‡Œçš„ `static int counter`ï¼š
  - åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶åˆå§‹åŒ–ä¸º 0
  - æ¯æ¬¡ `++counter` åè¾“å‡º 1, 2, ...
- `Counter::count_` æ˜¯ç±»çš„é™æ€æ•°æ®æˆå‘˜ï¼š
  - æ‰€æœ‰ `Counter` å¯¹è±¡å…±äº«ä¸€ä»½
  - `c1.inc()` â†’ count_ = 1
  - `c2.inc()` â†’ count_ = 2
  - `c1.get()` & `c2.get()` éƒ½æ˜¯ 2

**å…±åŒç‚¹ï¼š**

- éƒ½æœ‰é™æ€å­˜å‚¨æœŸï¼ˆç¨‹åºæ•´ä¸ªè¿è¡ŒæœŸé—´éƒ½å­˜åœ¨ï¼‰
- åªæœ‰ä¸€ä»½å…±äº«çš„å­˜å‚¨

**ä¸åŒç‚¹ï¼š**

- å±€éƒ¨ staticï¼šä½œç”¨åŸŸæ˜¯å‡½æ•°ä½“å†…
- ç±» staticï¼šä½œç”¨åŸŸåœ¨ç±»å†…ï¼Œé€šè¿‡ç±»åæˆ–å¯¹è±¡è®¿é—®

------

## 14. this çš„ç±»å‹ & const æˆå‘˜å‡½æ•°

ä½ çš„å›ç­”æ˜¯å®Œå…¨å¯¹çš„ï¼š

- é const æˆå‘˜å‡½æ•°ï¼š`ClassName* const this`
- const æˆå‘˜å‡½æ•°ï¼š`const ClassName* const this`

**åŸå› ï¼š**

- `const` å†™åœ¨å‡½æ•°ç­¾åæœ«å°¾ï¼Œå°±æ˜¯åœ¨å£°æ˜ï¼š

  > â€œè¿™ä¸ªæˆå‘˜å‡½æ•°é‡ŒæŠŠ `this` å½“ä½œ `const ClassName*`â€

äºæ˜¯ï¼š

- `this->member` è§†ä½œ const å¯¹è±¡çš„æˆå‘˜ â†’ ä¸èƒ½æ”¹æ™®é€šæˆå‘˜

è¿™å°±æ˜¯ const æˆå‘˜å‡½æ•°ç¦æ­¢ä¿®æ”¹æ™®é€šæˆå‘˜çš„æ ¹æœ¬åŸå› ã€‚

------

## 15. Buffer çš„ Rule of Five

ä½ æ•´ä½“æ€è·¯å¯¹ï¼Œä½†ä»£ç é‡Œæœ‰å‡ å¤„ bugï¼Œæˆ‘ç›´æ¥ç»™ä½ æ ‡å‡ºæ¥ï¼š

```cpp
// æ‹·è´æ„é€ 
Buffer(const Buffer& other){
    size_ = other.size_;
    data_ = new int[size_];
    for(int i = 0; i < size_; i++) data_[i] = other.data_[i];
}

// æ‹·è´èµ‹å€¼
Buffer& operator=(const Buffer& other){
    if(&other == this) return *this;
    size_ = other.size_;
    delete[] data_;
    // âŒ å°‘äº† new
    data_ = new int[size_];
    for(int i = 0; i < size_; i++) data_[i] = other.data_[i];
    return *this;
}
```

ç§»åŠ¨ç‰ˆæœ¬ä½ å†™æˆäº† `const Buffer&&`ï¼Œè¿™ä¸è¡Œï¼š

```cpp
// âŒ ä¸èƒ½ä» const å³å€¼å·èµ„æº
Buffer(const Buffer&& other) noexcept;
Buffer& operator=(const Buffer&& other) noexcept;
```

åº”è¯¥æ˜¯ï¼š

```cpp
Buffer(Buffer&& other) noexcept;
Buffer& operator=(Buffer&& other) noexcept;
```

æ•´ä½“æ­£ç¡®ç‰ˆæœ¬æˆ‘åœ¨å‰é¢ A ç±»é‚£ä¸€æ®µå·²ç»å±•ç¤ºäº†ä¸€æ¬¡ï¼Œä½ å¯ä»¥å¯¹ç…§çœ‹çœ‹ã€‚

------

## 16. FileHandle ç¦æ‹·è´ã€å…ç§»åŠ¨

ä½ çš„å›ç­”å¾ˆå¥½ï¼Œè¿™ä¸€é¢˜æˆ‘åªè¡¥ä¸¤ä¸ªç‚¹ï¼š

1. **æ–‡ä»¶å¥æŸ„ï¼ˆfile descriptorï¼‰**ï¼š
   - åœ¨ç±» Unix ç³»ç»Ÿä¸Šå°±æ˜¯ä¸€ä¸ª `int`ï¼Œç”±å†…æ ¸ç®¡ç†
   - æ¯ä¸€ä¸ª fd å¯¹åº”ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶ / socket / pipe
   - ä¸èƒ½â€œéšä¾¿æµ…æ‹·è´â€ï¼Œå¦åˆ™ä¸¤ä¸ªå¯¹è±¡éƒ½ä»¥ä¸ºè‡ªå·±æ˜¯â€œå”¯ä¸€æŒæœ‰è€…â€
2. ä½ çš„å£°æ˜ï¼š

```cpp
FileHandle(const FileHandle& other) = delete;
FileHandle& operator=(const FileHandle& other) = delete;

FileHandle(FileHandle&& other);
FileHandle& operator=(FileHandle&& other);
```

âœ” è¿™æ˜¯éå¸¸æ ‡å‡†çš„ **â€œç¦æ‹·è´ï¼Œå…ç§»åŠ¨â€** æ¥å£ã€‚

å¦‚æœå†æƒ³è¦æ›´å·¥ç¨‹ä¸€ç‚¹ï¼Œå¯ä»¥ç»™ç§»åŠ¨æ„é€ /èµ‹å€¼åŠ  `noexcept`ã€‚

------

## 17. Rule of Zero ç¤ºä¾‹ï¼ˆä½ è¯´ä¸ä¼šä¸¾ä¾‹ï¼‰

ç»™ä½ ä¸€ä¸ªéå¸¸è´´è¿‘ EDA çš„ç®€ç‰ˆä¾‹å­ï¼š

```cpp
class Net {
public:
    void AddPin(int pin) { pins_.push_back(pin); }
    const std::vector<int>& pins() const { return pins_; }

private:
    std::vector<int> pins_;
};
```

- è¿™é‡Œ `Net` è‡ªå·± **æ²¡æœ‰å†™ä»»ä½•ææ„ / æ‹·è´ / ç§»åŠ¨ç›¸å…³å‡½æ•°**

- æ‰€æœ‰èµ„æºç®¡ç†äº¤ç»™ `std::vector<int>` å®Œæˆ

- è¿™å°±æ˜¯ **Rule of Zero**ï¼š

  > â€œèƒ½è®©æ ‡å‡†åº“å¸®ä½ ç®¡èµ„æºï¼Œå°±åˆ«è‡ªå·±ç®¡ç†ã€‚â€

è¿™æ ·ï¼š

- æ‹·è´ Net â†’ è‡ªåŠ¨è°ƒç”¨ vector çš„æ‹·è´
- ç§»åŠ¨ Net â†’ è‡ªåŠ¨è°ƒç”¨ vector çš„ç§»åŠ¨
- ææ„ Net â†’ è‡ªåŠ¨ææ„ vector

ä½ åªå…³æ³¨â€œé€»è¾‘â€ï¼šAddPin / pinsï¼›
 å®Œå…¨ä¸ç”¨å…³å¿ƒå†…å­˜å¦‚ä½•é‡Šæ”¾ã€‚

------

## 18. å“ªäº› std::move åˆç†ï¼Ÿ

```cpp
std::string MakeString() {
    std::string s = "hello";
    return s;                // R1
}

void UseString(std::string s) { /* ... */ }

int main() {
    std::string a = "world";
    std::string b = MakeString();            // R2
    std::string c = std::move(a);            // R3

    UseString(a);                            // R4
    UseString(std::move(b));                 // R5
    UseString("tmp");                        // R6
}
```

- **R1**ï¼š`return s;`
  - ç°ä»£ C++ï¼ˆå°¤å…¶æ˜¯æœ‰è¿”å›å€¼ä¼˜åŒ–/ç§»åŠ¨ï¼‰ä¸‹ï¼Œè¿™é‡Œä¸è¦åŠ  `std::move`
  - ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨åš RVO / ç§»åŠ¨ï¼Œå†™ `return std::move(s);` åè€Œå¯èƒ½ç¦æ­¢æŸäº›ä¼˜åŒ– â†’ **ä¸ç”¨ move æ›´å¥½**
- **R2**ï¼š`std::string b = MakeString();`
  - è¿”å›çš„æ˜¯ prvalueï¼Œç›´æ¥åˆå§‹åŒ– `b`
  - é€šå¸¸æœ‰ RVOï¼Œç”šè‡³è¿ç§»åŠ¨éƒ½çœäº† â†’ åˆç†
- **R3**ï¼š`std::string c = std::move(a);`
  - è¿™ä¸€æ­¥æ˜¯æ­£ç¡®çš„â€œæ˜¾å¼ç§»åŠ¨â€ï¼Œä¹‹å `a` è¿›å…¥â€œå·²è¢«ç§»åŠ¨â€çš„çŠ¶æ€ï¼Œåªèƒ½åšæœ‰é™æ“ä½œ â†’ åˆç†ç”¨æ³•
- **R4**ï¼š`UseString(a);`
  - æŒ‰å€¼ä¼ å‚ï¼Œè¿™é‡Œä¼šæ‹·è´ä¸€ä»½ `a`
  - å¦‚æœä½ ä¸å†éœ€è¦ `a`ï¼Œå¯ä»¥ç”¨ `std::move(a)`ï¼Œä½†ä¸€èˆ¬å†™æ¸…æ¥šæ„å›¾å°±è¡Œ
- **R5**ï¼š`UseString(std::move(b));`
  - å‘Šè¯‰ç¼–è¯‘å™¨ï¼š`b` è¿™é‡Œå¯ä»¥â€œè¢«å·èµ„æºâ€ï¼ŒUseString å†…éƒ¨å¦‚æœç”¨ move ä¼˜åŒ–ä¼šæ›´é«˜æ•ˆ â†’ åˆç†
- **R6**ï¼š`UseString("tmp");`
  - å­—é¢é‡è½¬æ¢æˆä¸´æ—¶ `std::string` å†æ‹·è´/ç§»åŠ¨åˆ°å½¢å‚ `s` ä¸­ â†’ æ­£å¸¸ç”¨æ³•

ç®€å•è®°ï¼š

> **èƒ½ä¸èƒ½ç”¨ `std::move`**ï¼šçœ‹ä½ æ˜¯ä¸æ˜¯â€œ**ä¸å†éœ€è¦é‚£ä¸ªå¯¹è±¡çš„å€¼**â€ï¼Œè€Œä¸æ˜¯â€œæƒ³çœä¸€æ¬¡æ‹·è´â€ã€‚
>  æŠŠâ€œç”Ÿå‘½å‘¨æœŸè¦ç»“æŸâ€çš„é‡ç”¨ `std::move` æ˜¯åˆç†çš„ã€‚

------

## 19. å³å€¼å¼•ç”¨ï¼ˆT&&ï¼‰

ä½ ç°åœ¨æœ‰ä¸ªè¯¯åŒºï¼š**å³å€¼å¼•ç”¨ä¸æ˜¯â€œå»¶é•¿å³å€¼ç”Ÿå‘½å‘¨æœŸâ€**ã€‚

- â€œå»¶é•¿ä¸´æ—¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸâ€çš„æ˜¯ **`const T&` ç»‘å®šä¸´æ—¶** çš„è¯­ä¹‰ï¼›
- `T&&` åªæ˜¯ä¸€ä¸ªâ€œå¯ä»¥ç»‘å®šåˆ°å³å€¼çš„å¼•ç”¨ç±»å‹â€ã€‚

### âœ… ç²—æš´è®°æ³•ï¼š

- `T&`ï¼šåªèƒ½ç»‘åˆ°å·¦å€¼
- `const T&`ï¼šå¯ä»¥ç»‘åˆ°å·¦å€¼ / å³å€¼ï¼ˆä¸´æ—¶å¯¹è±¡ï¼‰
- `T&&`ï¼š**åªèƒ½ç»‘åˆ°å³å€¼**ï¼ˆåŒ…æ‹¬ `std::move(x)` è¿™ç§ xvalueï¼‰

å…¸å‹ç”¨é€”ï¼š

1. **ç§»åŠ¨æ„é€  / ç§»åŠ¨èµ‹å€¼**ï¼š

```cpp
A(A&& other) noexcept;             // ä»å³å€¼å·èµ„æº
A& operator=(A&& other) noexcept;
```

1. **æä¾›é«˜æ•ˆçš„â€œæ¥æ”¶ä¸´æ—¶å¯¹è±¡â€çš„æ¥å£**ï¼š

```cpp
class V {
public:
    void setName(std::string s);        // æ‹·è´ç‰ˆ
    void setName(std::string&& s);      // ç§»åŠ¨ç‰ˆ
};
```

------

## 20. ä½ è¯´å…ˆä¸è®² â†’ æš‚æ—¶ç•¥è¿‡ï¼Œç­‰ä½ ä»¥åéœ€è¦å®Œç¾è½¬å‘æ—¶æˆ‘ä»¬å†å¼€ä¸€èŠ‚ä¸“è®² ğŸ‘

------

## 21. TimingNode è®¾è®¡

ä½ è¿™é¢˜çš„æ€è·¯æ˜¯å¯¹çš„ï¼Œä¸è¿‡ä»£ç é‡Œé—®é¢˜æ¯”è¾ƒå¤šï¼Œæˆ‘ç›´æ¥ç»™ä½ ä¸€ä»½â€œé¢è¯•å¯ç”¨ç‰ˆâ€ä½œä¸ºå‚è€ƒï¼š

```cpp
class TimingNode {
public:
    TimingNode(double arrival = 0.0, double required = 0.0)
        : id_(next_id_++)
        , arrival_(arrival)
        , required_(required)
    {}

    // ç¦æ­¢æ‹·è´
    TimingNode(const TimingNode&)            = delete;
    TimingNode& operator=(const TimingNode&) = delete;

    // å…è®¸ç§»åŠ¨
    TimingNode(TimingNode&&) noexcept            = default;
    TimingNode& operator=(TimingNode&&) noexcept = default;

    int id() const { return id_; }

    double arrival() const  { return arrival_; }
    double required() const { return required_; }

    double slack() const {
        if (!slack_computed_) {
            slack_ = arrival_ - required_;
            slack_computed_ = true;
        }
        return slack_;
    }

private:
    const int   id_;
    double      arrival_  = 0.0;
    double      required_ = 0.0;

    mutable bool   slack_computed_ = false;
    mutable double slack_          = 0.0;

    static int next_id_;
};

int TimingNode::next_id_ = 0;
```

ä½ æƒ³è¡¨è¾¾çš„ç‚¹è¿™é‡Œéƒ½ä½“ç°äº†ï¼š

- å”¯ä¸€ IDï¼ˆstatic è®¡æ•°å™¨ + const æˆå‘˜ï¼‰
- slack ç¼“å­˜ï¼ˆmutable + const æˆå‘˜å‡½æ•°ï¼‰
- ç¦æ‹·è´ / å…ç§»åŠ¨ï¼ˆRule of Five æ€æƒ³ï¼‰

------

## 22. åªç®€å•å›ä¸€ä¸‹ä½ å·²ç»å†™çš„ç‚¹ï¼ˆä¸å±•å¼€ RAIIï¼‰

ä½ å†™çš„å‡ ä¸ªå±å®³éƒ½å¯¹ï¼š

1. **ä¸å†™ const æˆå‘˜å‡½æ•° / ä¸åš const é‡è½½**ï¼š
   - å¾ˆå®¹æ˜“åœ¨â€œçœ‹èµ·æ¥åªæ˜¯è¯»â€çš„å‡½æ•°é‡Œæ„å¤–ä¿®æ”¹å¯¹è±¡
   - å…¶ä»–äººç”¨ `const Graph&` ä¹Ÿæ²¡æ³•è°ƒç”¨ä½ é‚£äº›æ¥å£ â†’ ç±»å‹ç³»ç»Ÿå¸®ä¸äº†ä½ 
2. **å¤§é‡ public æˆå‘˜å˜é‡**ï¼š
   - ä»»ä½•äººéƒ½å¯ä»¥éšæ—¶æ”¹å†…éƒ¨çŠ¶æ€
   - ä¸å˜å¼ï¼ˆä¾‹å¦‚ arrival/required/slack çš„å…³ç³»ï¼‰å¾ˆå®¹æ˜“è¢«ç ´å
   - Bug å®šä½éš¾åº¦æŒ‡æ•°çº§ä¸Šå‡
3. **ä¸åŒºåˆ†æ‹·è´ / ç§»åŠ¨è¯­ä¹‰ï¼Œéšæ„æ‹·è´å¤§å¯¹è±¡**ï¼š
   - æ€§èƒ½ç¾éš¾ï¼Œå°¤å…¶æ˜¯å¤§å›¾ã€å¤§ç½‘è¡¨è¿™ç§å‡  MB ç”šè‡³ GB çš„ç»“æ„
   - é‡åˆ°è¯¯æ‹·è´è¿˜å¯èƒ½å¯¼è‡´é€»è¾‘ Bugï¼ˆä¸¤ä»½çŠ¶æ€ä¸ä¸€è‡´ï¼‰

ç¬¬ 4 ç‚¹ RAII æˆ‘æŒ‰ä½ çš„è¦æ±‚æš‚æ—¶ä¸å±•å¼€ï¼Œä½ åé¢å­¦åˆ°æ™ºèƒ½æŒ‡é’ˆå’Œèµ„æºç®¡ç†é‚£å—ï¼Œæˆ‘ä»¬å¯ä»¥å¼€ä¸€æ•´èŠ‚ä¸“é—¨èŠã€‚

------

## æœ€åç»™ä½ ä¸€ç‚¹åé¦ˆ

ä½ æ˜¨å¤©èƒ½èŠ±ä¸‰ä¸ªå°æ—¶å•ƒå®Œè¿™ç§å¼ºåº¦çš„é¢˜ï¼Œè€Œä¸”å¤§éƒ¨åˆ†åœ°æ–¹ç†è§£éƒ½æ˜¯**æ–¹å‘æ­£ç¡®ï¼Œåªå·®ç»†èŠ‚**ï¼Œè¿™å·²ç»éå¸¸å‰å®³äº†ã€‚

æ¥ä¸‹æ¥æˆ‘å»ºè®®ï¼š

- æŠŠä»Šå¤©è¿™ä¸ªæ‰¹æ”¹ç­”æ¡ˆæ”¶è—èµ·æ¥ï¼Œ
- è¿‡ä¸€ä¸¤å¤©å†è‡ªå·±â€œé—­å·å¤è¿°â€ä¸€éï¼š
  - è¯´æ¸…ï¼š**é‡è½½ / é‡å†™ / éšè—** åŒºåˆ«
  - Rule of Five çš„äº”ä¸ªå‡½æ•° & ç§»åŠ¨æ„é€ /èµ‹å€¼çš„å…¸å‹å†™æ³•
  - const / mutable / static / this çš„ç»„åˆé€»è¾‘

å¦‚æœä½ æ„¿æ„ï¼Œä¸‹ä¸€æ­¥æˆ‘å¯ä»¥ç»™ä½ ä¸€ä»½**ç¬¬äºŒç« â€œæç®€å°æŠ„â€**ç‰ˆæœ¬ï¼š
 ä¸€å±èƒ½çœ‹å®Œé‚£ç§ï¼Œæ–¹ä¾¿ä½ é¢è¯•å‰ 10 åˆ†é’Ÿå¿«é€Ÿç¿»ä¸€ç¿»ã€‚ä½ è¦çš„è¯æˆ‘å°±ç»™ä½ åšä¸€ä»½ã€‚
